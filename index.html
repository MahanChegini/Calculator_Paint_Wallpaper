import { useState } from "react";
import { Switch } from "@/components/ui/switch";
import { Input } from "@/components/ui/input";
import { Card } from "@/components/ui/card";
import { motion } from "framer-motion";

const roomTips = {
  "ุงุชุงู ฺฉูุฏฺฉ": "ุฑูฺฏ ูพุดููุงุฏ: ุขุจ ููุงู ุง ุณุจุฒ ูุนูุงุน. ุงุฒ ุฑูฺฏโูุง ุจุฏูู ุจู ู ุถุฏ ุญุณุงุณุช ุงุณุชูุงุฏู ฺฉู.",
  "ูพุฐุฑุง": "ุงุฒ ุฑูฺฏโูุง ฺฏุฑู ู ฺฉุงุบุฐ ุฏูุงุฑ ูููุงู ุงุณุชูุงุฏู ฺฉู. ุฏูุงุฑ ุงุตู ุฑู ุฎู ุดููุบ ูฺฉู.",
  "ุญูุงู": "ุงุฒ ุฑูฺฏโูุง ุฑูุดู ู ุถุฏ ุขุจ ุงุณุชูุงุฏู ฺฉู. ุฑูฺฏโูุง ุณุฑุฏ ูุซู ุทูุณ ุฑูุดู ููุงุณุจ ูุณุชู.",
  "ุขุดูพุฒุฎุงูู": "ุฑูฺฏโูุง ูุงุจู ุดุณุชโูุดู ู ุฑูุดู ูุซู ุณูุฏ ุง ฺฉุฑู. ฺฉุงุบุฐ ุฏูุงุฑ ููุงุณุจ ูุณุช."
};

const brands = {
  "ฺฉุงูพุงุฑูู": 320000,
  "ุณุญุฑ": 250000,
  "ููพูู": 280000
};

const InteriorCalculator = () => {
  const [theme, setTheme] = useState("light");
  const [form, setForm] = useState({
    name: "",
    width: "",
    length: "",
    height: "",
    walls: "",
    windowArea: "",
    wallType: "ฺฏฺ",
    brand: "ฺฉุงูพุงุฑูู"
  });

  const toggleTheme = () => {
    setTheme(theme === "light" ? "dark" : "light");
    document.documentElement.classList.toggle("dark");
  };

  const surfaceArea = () => {
    const w = parseFloat(form.width);
    const l = parseFloat(form.length);
    const h = parseFloat(form.height);
    const walls = parseInt(form.walls);
    const win = parseFloat(form.windowArea);
    if (isNaN(w) || isNaN(l) || isNaN(h) || isNaN(walls)) return 0;
    return (walls * h * (w + l) / 2) - (win || 0);
  };

  const calcPaint = () => {
    const area = surfaceArea();
    const price = brands[form.brand];
    const literPerM2 = 0.1;
    const needed = Math.ceil(area * literPerM2 / 4); // assuming each can is 4L
    return { needed, price: needed * price };
  };

  const { needed, price } = calcPaint();

  return (
    <div className="min-h-screen flex flex-col items-center justify-center bg-gray-100 dark:bg-neutral-900 px-4">
      <div className="absolute top-4 right-4">
        <Switch checked={theme === "dark"} onCheckedChange={toggleTheme}>
          <span className="ml-2">{theme === "dark" ? "๐" : "โ๏ธ"}</span>
        </Switch>
      </div>
      <motion.div
        className="w-full max-w-xl bg-white dark:bg-neutral-800 p-6 rounded-2xl shadow-2xl"
        initial={{ opacity: 0, y: 50 }}
        animate={{ opacity: 1, y: 0 }}
      >
        <h2 className="text-2xl font-bold mb-4 text-center font-iranYekan dark:text-white">
          ูุญุงุณุจูโฺฏุฑ ุชุฎุตุต ุทุฑุงุญ ุฏุงุฎู โ ููุงุณุจ ูุนูุงุฑุงู ู ููุงุดุงู
        </h2>
        <div className="space-y-3">
          <Input
            placeholder="ูุงู ูุถุง (ูุซูุงู ูพุฐุฑุงุ ุงุชุงู ฺฉูุฏฺฉุ ... )"
            value={form.name}
            onChange={(e) => setForm({ ...form, name: e.target.value })}
          />
          <Input placeholder="ุทูู (ูุชุฑ)" value={form.length} onChange={(e) => setForm({ ...form, length: e.target.value })} />
          <Input placeholder="ุนุฑุถ (ูุชุฑ)" value={form.width} onChange={(e) => setForm({ ...form, width: e.target.value })} />
          <Input placeholder="ุงุฑุชูุงุน (ูุชุฑ)" value={form.height} onChange={(e) => setForm({ ...form, height: e.target.value })} />
          <Input placeholder="ุชุนุฏุงุฏ ุฏูุงุฑูุง" value={form.walls} onChange={(e) => setForm({ ...form, walls: e.target.value })} />
          <Input placeholder="ูุฌููุน ูุชุฑุงฺ ูพูุฌุฑูโูุง" value={form.windowArea} onChange={(e) => setForm({ ...form, windowArea: e.target.value })} />
          <select
            className="w-full p-2 rounded border border-gray-300"
            value={form.wallType}
            onChange={(e) => setForm({ ...form, wallType: e.target.value })}
          >
            <option>ฺฏฺ</option>
            <option>ุณูุงู</option>
            <option>ุฑูฺฏโุดุฏู ูุจู</option>
            <option>ฺฉุงุบุฐ</option>
          </select>
          <select
            className="w-full p-2 rounded border border-gray-300"
            value={form.brand}
            onChange={(e) => setForm({ ...form, brand: e.target.value })}
          >
            {Object.keys(brands).map((b) => (
              <option key={b}>{b}</option>
            ))}
          </select>
        </div>
        <div className="mt-6 p-4 rounded-lg bg-blue-50 dark:bg-blue-900/30 text-blue-800 dark:text-white">
          {form.name && roomTips[form.name] && (
            <p className="text-sm">๐ก {roomTips[form.name]}</p>
          )}
          <p className="mt-2">๐จ ูุชุฑุงฺ ุณุทุญ: {surfaceArea().toFixed(2)} ูุชุฑูุฑุจุน</p>
          <p>๐ฒ ุชุนุฏุงุฏ ููุท ุฑูฺฏ ููุฑุฏูุงุฒ: {needed} ุนุฏุฏ</p>
          <p>๐ฐ ููุช ุญุฏูุฏ: {price.toLocaleString()} ุชููุงู</p>
        </div>
        <div className="mt-4 text-sm text-gray-700 dark:text-gray-300">
          <p>โข ุฑูฺฏ ูพุดููุงุฏ ุจุฑุง ูุถุง ฺฉูุฏฺฉ: ุขุจ ููุงู ุง ุณุจุฒ ูุนูุงุน</p>
          <p>โข ฺฉุงุบุฐ ุฏูุงุฑ ุทุฑุญ ฺฏูโุฏุงุฑ ุจุฑุง ุฏูุงุฑ ุงุตู ูพุฐุฑุง ุชูุตู ููโุดูุฏ</p>
          <p>โข ุณูู ฺฉูุชุงู ุฏุงุฑุ ุงุฒ ุฑูฺฏโูุง ุฑูุดู ุงุณุชูุงุฏู ฺฉู</p>
        </div>
      </motion.div>
    </div>
  );
};

export default InteriorCalculator;
