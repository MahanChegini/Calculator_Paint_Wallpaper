import { useState } from "react";
import { Switch } from "@/components/ui/switch";
import { Input } from "@/components/ui/input";
import { Card } from "@/components/ui/card";
import { motion } from "framer-motion";

const roomTips = {
  "اتاق کودک": "رنگ پیشنهادی: آبی ملایم یا سبز نعناعی. از رنگ‌های بدون بو و ضد حساسیت استفاده کن.",
  "پذیرایی": "از رنگ‌های گرم و کاغذ دیواری مینیمال استفاده کن. دیوار اصلی رو خیلی شلوغ نکن.",
  "حمام": "از رنگ‌های روشن و ضد آب استفاده کن. رنگ‌های سرد مثل طوسی روشن مناسب هستن.",
  "آشپزخانه": "رنگ‌های قابل شست‌وشو و روشن مثل سفید یا کرم. کاغذ دیواری مناسب نیست."
};

const brands = {
  "کاپارول": 320000,
  "سحر": 250000,
  "نیپون": 280000
};

const InteriorCalculator = () => {
  const [theme, setTheme] = useState("light");
  const [form, setForm] = useState({
    name: "",
    width: "",
    length: "",
    height: "",
    walls: "",
    windowArea: "",
    wallType: "گچی",
    brand: "کاپارول"
  });

  const toggleTheme = () => {
    setTheme(theme === "light" ? "dark" : "light");
    document.documentElement.classList.toggle("dark");
  };

  const surfaceArea = () => {
    const w = parseFloat(form.width);
    const l = parseFloat(form.length);
    const h = parseFloat(form.height);
    const walls = parseInt(form.walls);
    const win = parseFloat(form.windowArea);
    if (isNaN(w) || isNaN(l) || isNaN(h) || isNaN(walls)) return 0;
    return (walls * h * (w + l) / 2) - (win || 0);
  };

  const calcPaint = () => {
    const area = surfaceArea();
    const price = brands[form.brand];
    const literPerM2 = 0.1;
    const needed = Math.ceil(area * literPerM2 / 4); // assuming each can is 4L
    return { needed, price: needed * price };
  };

  const { needed, price } = calcPaint();

  return (
    <div className="min-h-screen flex flex-col items-center justify-center bg-gray-100 dark:bg-neutral-900 px-4">
      <div className="absolute top-4 right-4">
        <Switch checked={theme === "dark"} onCheckedChange={toggleTheme}>
          <span className="ml-2">{theme === "dark" ? "🌙" : "☀️"}</span>
        </Switch>
      </div>
      <motion.div
        className="w-full max-w-xl bg-white dark:bg-neutral-800 p-6 rounded-2xl shadow-2xl"
        initial={{ opacity: 0, y: 50 }}
        animate={{ opacity: 1, y: 0 }}
      >
        <h2 className="text-2xl font-bold mb-4 text-center font-iranYekan dark:text-white">
          محاسبه‌گر تخصصی طراحی داخلی – مناسب معماران و نقاشان
        </h2>
        <div className="space-y-3">
          <Input
            placeholder="نام فضا (مثلاً پذیرایی، اتاق کودک، ... )"
            value={form.name}
            onChange={(e) => setForm({ ...form, name: e.target.value })}
          />
          <Input placeholder="طول (متر)" value={form.length} onChange={(e) => setForm({ ...form, length: e.target.value })} />
          <Input placeholder="عرض (متر)" value={form.width} onChange={(e) => setForm({ ...form, width: e.target.value })} />
          <Input placeholder="ارتفاع (متر)" value={form.height} onChange={(e) => setForm({ ...form, height: e.target.value })} />
          <Input placeholder="تعداد دیوارها" value={form.walls} onChange={(e) => setForm({ ...form, walls: e.target.value })} />
          <Input placeholder="مجموع متراژ پنجره‌ها" value={form.windowArea} onChange={(e) => setForm({ ...form, windowArea: e.target.value })} />
          <select
            className="w-full p-2 rounded border border-gray-300"
            value={form.wallType}
            onChange={(e) => setForm({ ...form, wallType: e.target.value })}
          >
            <option>گچی</option>
            <option>سیمانی</option>
            <option>رنگ‌شده قبلی</option>
            <option>کاغذی</option>
          </select>
          <select
            className="w-full p-2 rounded border border-gray-300"
            value={form.brand}
            onChange={(e) => setForm({ ...form, brand: e.target.value })}
          >
            {Object.keys(brands).map((b) => (
              <option key={b}>{b}</option>
            ))}
          </select>
        </div>
        <div className="mt-6 p-4 rounded-lg bg-blue-50 dark:bg-blue-900/30 text-blue-800 dark:text-white">
          {form.name && roomTips[form.name] && (
            <p className="text-sm">💡 {roomTips[form.name]}</p>
          )}
          <p className="mt-2">🎨 متراژ سطح: {surfaceArea().toFixed(2)} مترمربع</p>
          <p>🔲 تعداد قوطی رنگ موردنیاز: {needed} عدد</p>
          <p>💰 قیمت حدودی: {price.toLocaleString()} تومان</p>
        </div>
        <div className="mt-4 text-sm text-gray-700 dark:text-gray-300">
          <p>• رنگ پیشنهادی برای فضای کودک: آبی ملایم یا سبز نعناعی</p>
          <p>• کاغذ دیواری طرح گل‌دار برای دیوار اصلی پذیرایی توصیه نمی‌شود</p>
          <p>• سقف کوتاه داری؟ از رنگ‌های روشن استفاده کن</p>
        </div>
      </motion.div>
    </div>
  );
};

export default InteriorCalculator;
